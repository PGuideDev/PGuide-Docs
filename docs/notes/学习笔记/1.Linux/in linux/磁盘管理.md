---
title: ç£ç›˜ç®¡ç†
createTime: 2025/06/11 04:39:08
permalink: /learning-notes/linux/disk-management/
icon: icon-park-twotone:hard-disk
---

# Linuxç£ç›˜ç®¡ç†æŒ‡å—

## ğŸ“ æŸ¥çœ‹ç£ç›˜ä¿¡æ¯

### ğŸ” åˆ—å‡ºå¯ç”¨ç£ç›˜

```bash
lsblk               # ç®€å•åˆ—å‡ºå—è®¾å¤‡
fdisk -l            # è¯¦ç»†ç£ç›˜ä¿¡æ¯
df -h               # æ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µï¼ˆäººç±»å¯è¯»ï¼‰
```

### ğŸ”¬ ç£ç›˜è¯¦ç»†ä¿¡æ¯

```bash
hdparm -I /dev/sda   # æŸ¥çœ‹ç£ç›˜ç‰¹å¾ï¼ˆéœ€è¦rootï¼‰
smartctl -a /dev/sda # æŸ¥çœ‹S.M.A.R.T.ä¿¡æ¯ï¼ˆéœ€å®‰è£…smartmontoolsï¼‰
```

## ğŸ“Š åˆ†åŒºç®¡ç†

### ğŸ†• åˆ›å»ºæ–°åˆ†åŒº

```bash
fdisk /dev/sdb       # äº¤äº’å¼åˆ†åŒºå·¥å…·
gdisk /dev/sdb       # å¤„ç†GPTåˆ†åŒº
parted /dev/sdb      # é«˜çº§åˆ†åŒºå·¥å…·
```

### â• å¸¸ç”¨fdiskå‘½ä»¤ï¼š

| å‘½ä»¤  | åŠŸèƒ½      |
|-----|---------|
| `n` | åˆ›å»ºæ–°åˆ†åŒº   |
| `d` | åˆ é™¤åˆ†åŒº    |
| `p` | æ˜¾ç¤ºåˆ†åŒºè¡¨   |
| `t` | æ›´æ”¹åˆ†åŒºç±»å‹  |
| `w` | ä¿å­˜æ›´æ”¹å¹¶é€€å‡º |
| `q` | é€€å‡ºä¸ä¿å­˜æ›´æ”¹ |

## ğŸ“› æ ¼å¼åŒ–åˆ†åŒº

### ğŸ§± åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ

```bash
mkfs.ext4 /dev/sdb1        # åˆ›å»ºext4æ–‡ä»¶ç³»ç»Ÿ
mkfs.xfs /dev/sdb2         # åˆ›å»ºXFSæ–‡ä»¶ç³»ç»Ÿ
mkfs.ntfs /dev/sdb3        # åˆ›å»ºNTFSæ–‡ä»¶ç³»ç»Ÿ
```

### ğŸ”„ æ ¼å¼åŒ–ä¸ºswapåˆ†åŒº

```bash
mkswap /dev/sdb4          # åˆ›å»ºswapåˆ†åŒº
swapon /dev/sdb4          # æ¿€æ´»swapåˆ†åŒº
```

## ğŸ“Œ æŒ‚è½½ä¸å¸è½½

### â›“ æ‰‹åŠ¨æŒ‚è½½

```bash
mount /dev/sdb1 /mnt/data  # æŒ‚è½½åˆ°æŒ‡å®šç›®å½•
umount /mnt/data           # å¸è½½åˆ†åŒº
```

### ğŸ”— æ°¸ä¹…æŒ‚è½½ï¼ˆ/etc/fstabï¼‰

```bash
# æ ¼å¼ï¼š<è®¾å¤‡> <æŒ‚è½½ç‚¹> <æ–‡ä»¶ç³»ç»Ÿ> <é€‰é¡¹> <dump> <fsck>
/dev/sdb1   /mnt/data   ext4   defaults   0   2
```

### ğŸŒ æŒ‚è½½è¿œç¨‹æ–‡ä»¶ç³»ç»Ÿ

```bash
mount -t nfs server:/shared /mnt/nfs
mount -t cifs //server/share /mnt/smb -o user=username
```

## ğŸ”„ LVMï¼ˆé€»è¾‘å·ç®¡ç†ï¼‰

### ğŸ”§ LVMåŸºæœ¬æ“ä½œ

```bash
pvcreate /dev/sdb1             # åˆ›å»ºç‰©ç†å·
vgcreate vg_data /dev/sdb1     # åˆ›å»ºå·ç»„
lvcreate -L 10G -n lv_data vg_data # åˆ›å»ºé€»è¾‘å·
mkfs.xfs /dev/vg_data/lv_data  # æ ¼å¼åŒ–é€»è¾‘å·
mount /dev/vg_data/lv_data /data # æŒ‚è½½
```

### ğŸ†™ æ‰©å±•é€»è¾‘å·

```bash
lvextend -L +5G /dev/vg_data/lv_data # æ‰©å±•LVå¤§å°
resize2fs /dev/vg_data/lv_data      # è°ƒæ•´ext2/3/4æ–‡ä»¶ç³»ç»Ÿ
xfs_growfs /data                    # è°ƒæ•´XFSæ–‡ä»¶ç³»ç»Ÿ
```

## ğŸ§¹ ç£ç›˜ç»´æŠ¤

### ğŸ” æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿ

```bash
fsck /dev/sdb1   # æ£€æŸ¥å’Œä¿®å¤æ–‡ä»¶ç³»ç»Ÿï¼ˆéœ€å…ˆå¸è½½ï¼‰
```

### ğŸ§¬ ä¼˜åŒ–ç£ç›˜æ€§èƒ½

```bash
# è°ƒæ•´ext4æ—¥å¿—çº§åˆ«
tune2fs -o journal_data_writeback /dev/sdb1

# XFSç¢ç‰‡æ•´ç†
xfs_fsr /dev/sdb2

# è°ƒåº¦ç®—æ³•è°ƒæ•´ï¼ˆDeadline/CFQ/NOOPï¼‰
echo deadline > /sys/block/sda/queue/scheduler
```

## ğŸ“ ç£ç›˜é…é¢ç®¡ç†

```bash
quotaon -avug                      # å¯ç”¨é…é¢
edquota -u username                # ç¼–è¾‘ç”¨æˆ·é…é¢
repquota -a                        # æŸ¥çœ‹é…é¢æŠ¥å‘Š

# /etc/fstabå¯ç”¨é…é¢ï¼š
/dev/sdb1   /home   ext4   defaults,usrquota,grpquota   0   2
```

## ğŸ”„ RAIDç®¡ç†ï¼ˆmdadmï¼‰

### ğŸ›¡ åˆ›å»ºRAIDé˜µåˆ—

```bash
mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sdb1 /dev/sdc1
```

### ğŸ–¥ RAIDç›‘æ§

```bash
cat /proc/mdstat            # æŸ¥çœ‹RAIDçŠ¶æ€
mdadm --detail /dev/md0     # æŸ¥çœ‹è¯¦ç»†RAIDä¿¡æ¯
```

## ğŸ§© å¸¸ç”¨å·¥å…·æ€»ç»“

| å·¥å…·       | ç”¨é€”            | ç¤ºä¾‹                      |
|----------|---------------|-------------------------|
| `lsblk`  | åˆ—å‡ºå—è®¾å¤‡æ ‘å½¢ç»“æ„     | `lsblk -f`              |
| `fdisk`  | ä¼ ç»Ÿåˆ†åŒºå·¥å…·        | `fdisk -l`              |
| `parted` | é«˜çº§åˆ†åŒºå·¥å…·ï¼ˆæ”¯æŒå¤§ç£ç›˜ï¼‰ | `parted /dev/sdb print` |
| `mkfs`   | åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ        | `mkfs.ext4 /dev/sdb1`   |
| `mount`  | æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ        | `mount -t nfs4`         |
| `lvm`    | é€»è¾‘å·ç®¡ç†         | `lvdisplay`             |
| `du`     | æŸ¥çœ‹ç›®å½•å ç”¨ç©ºé—´      | `du -sh /home`          |
| `ncdu`   | äº¤äº’å¼ç£ç›˜ä½¿ç”¨åˆ†æ     | `ncdu /`                |
| `iotop`  | ç›‘æ§ç£ç›˜I/Oæ´»åŠ¨     | `iotop -oPa`            |

ğŸ’¡ **é‡è¦æç¤ºï¼š**

1. æ“ä½œç£ç›˜å‰åŠ¡å¿…å¤‡ä»½é‡è¦æ•°æ®
2. `fdisk`/`parted`ç­‰æ“ä½œä¼šç ´åæ•°æ®
3. æ°¸ä¹…æŒ‚è½½é…ç½®éœ€ä»”ç»†æ£€æŸ¥/etc/fstabè¯­æ³•
4. LVMæä¾›åŠ¨æ€è°ƒæ•´ç£ç›˜ç©ºé—´çš„çµæ´»æ€§

> ğŸ“Œ é€šè¿‡ä»¥ä¸Šå·¥å…·å’Œå‘½ä»¤ï¼Œæ‚¨å¯ä»¥é«˜æ•ˆåœ°ç®¡ç†å’Œç»´æŠ¤Linuxç³»ç»Ÿä¸­çš„ç£ç›˜èµ„æºã€‚