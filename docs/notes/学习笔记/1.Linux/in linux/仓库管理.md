---
title: ä»“åº“ç®¡ç†
createTime: 2025/06/11 04:44:33
permalink: /learning-notes/linux/repository-management/
icon: mdi:source-repository-multiple
---


# Linux è½¯ä»¶ä»“åº“ç®¡ç†æŒ‡å—

## ğŸ“¦ åŒ…ç®¡ç†ç³»ç»Ÿç®€ä»‹

| å‘è¡Œç‰ˆå®¶æ— | åŒ…ç®¡ç†å·¥å…· | é…ç½®æ–‡ä»¶ä½ç½® |
|------------|------------|--------------|
| Debian/Ubuntu | APT (apt) | `/etc/apt/sources.list`, `/etc/apt/sources.list.d/*.list` |
| Red Hat/CentOS | YUM/DNF | `/etc/yum.repos.d/*.repo` |
| Arch/Manjaro | Pacman | `/etc/pacman.conf`, `/etc/pacman.d/mirrorlist` |
| openSUSE | Zypper | `/etc/zypp/repos.d/*.repo` |
| Gentoo | Portage | `/etc/portage/repos.conf`, `/etc/portage/make.conf` |

## ğŸ” æŸ¥çœ‹ä»“åº“ä¿¡æ¯

### APT (Debian/Ubuntu)
```bash
apt policy                         # æ˜¾ç¤ºè½¯ä»¶åŒ…æ¥æº
apt-cache policy <package>         # æŸ¥çœ‹ç‰¹å®šåŒ…çš„ä»“åº“ä¿¡æ¯
grep -r --include '*.list' '^deb ' /etc/apt  # åˆ—å‡ºæ‰€æœ‰å¯ç”¨ä»“åº“
```

### DNF/YUM (RHEL/CentOS/Fedora)
```bash
dnf repolist all                  # åˆ—å‡ºæ‰€æœ‰ä»“åº“(å¯ç”¨/ç¦ç”¨)
dnf repository-packages <repo> info  # æŸ¥çœ‹æŒ‡å®šä»“åº“ä¸­çš„åŒ…
yum repoinfo <repo-name>          # æ˜¾ç¤ºä»“åº“è¯¦ç»†ä¿¡æ¯
```

### Pacman (Arch/Manjaro)
```bash
pacman -Syy                       # å¼ºåˆ¶åˆ·æ–°ä»“åº“ç´¢å¼•
pacman -Sl                        # åˆ—å‡ºæ‰€æœ‰ä»“åº“ä¸­çš„åŒ…
grep -E '^\s*\[.+]' /etc/pacman.conf  # æŸ¥çœ‹å¯ç”¨ä»“åº“
```

## âš™ï¸ ç®¡ç†ä»“åº“é…ç½®æ–‡ä»¶

### Debian/Ubuntu (APT)
```bash
sudo nano /etc/apt/sources.list   # ç¼–è¾‘ä¸»ä»“åº“é…ç½®
sudo nano /etc/apt/sources.list.d/my-repo.list  # æ·»åŠ æ–°ä»“åº“
```

ç¤ºä¾‹ä»“åº“æ¡ç›®:
```conf
deb https://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse
deb-src https://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse
```

### RHEL/CentOS (YUM/DNF)
```bash
sudo nano /etc/yum.repos.d/epel.repo  # ç¼–è¾‘ä»“åº“é…ç½®
```

ç¤ºä¾‹ä»“åº“é…ç½®:
```conf
[epel]
name=Extra Packages for Enterprise Linux $releasever - $basearch
baseurl=https://download.example/pub/epel/$releasever/Everything/$basearch
enabled=1
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-9
```

## ğŸ”„ æ·»åŠ æ–°ä»“åº“

### APT (Debian/Ubuntu)
```bash
sudo add-apt-repository ppa:user/ppa-name  # æ·»åŠ PPAä»“åº“
sudo add-apt-repository "deb [arch=amd64] https://download.example.com/ubuntu focal main"
sudo apt update
```

### DNF (Fedora/CentOS)
```bash
sudo dnf config-manager --add-repo https://download.example.com/repo/repo.repo
sudo dnf config-manager --enable <repo-name>
sudo dnf update
```

### Pacman (Arch)
```bash
sudo nano /etc/pacman.conf  # æ·»åŠ ä»“åº“åˆ°é…ç½®æ–‡ä»¶
[archlinuxcn]
Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch
```

## ğŸ›‘ ç¦ç”¨/å¯ç”¨ä»“åº“

### APT (Debian/Ubuntu)
```bash
sudo add-apt-repository --remove ppa:user/ppa-name  # ç¦ç”¨PPA
sudo nano /etc/apt/sources.list  # æ³¨é‡Šæ‰ä»“åº“è¡Œ
sudo apt update
```

### DNF (Fedora/RHEL)
```bash
sudo dnf config-manager --set-disabled <repo-name>   # ç¦ç”¨ä»“åº“
sudo dnf config-manager --set-enabled <repo-name>    # å¯ç”¨ä»“åº“
sudo dnf repolist                                     # éªŒè¯çŠ¶æ€
```

### Pacman (Arch)
åœ¨`/etc/pacman.conf`ä¸­æ³¨é‡Šæ‰ä»“åº“éƒ¨åˆ†:
```conf
#[archlinuxcn]
#Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch
```

## ğŸ” ç®¡ç†ä»“åº“å¯†é’¥

### APT (Debian/Ubuntu)
```bash
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys <KEYID>  # æ·»åŠ å¯†é’¥
sudo apt-key list                     # åˆ—å‡ºæ‰€æœ‰å¯†é’¥
sudo apt-key del <keyID>              # åˆ é™¤å¯†é’¥
```

### RPM (DNF/YUM)
```bash
sudo rpm --import https://example.com/key.asc    # å¯¼å…¥å¯†é’¥
sudo rpm -qa gpg-pubkey*                         # åˆ—å‡ºå·²å®‰è£…å¯†é’¥
sudo rpm -e gpg-pubkey-<id>                     # åˆ é™¤å¯†é’¥
```

### Pacman (Arch)
```bash
sudo pacman-key --recv-keys <KEYID>              # æ·»åŠ å¯†é’¥
sudo pacman-key --lsign-key <KEYID>              # æœ¬åœ°ç­¾åå¯†é’¥
sudo pacman -S archlinuxcn-keyring               # å®‰è£…ä¿¡ä»»å¯†é’¥ç¯
```

## ğŸ§© å¸¸ç”¨ä»“åº“ç®¡ç†å‘½ä»¤

### æ›´æ–°ä»“åº“å…ƒæ•°æ®
```bash
apt update                 # Debian/Ubuntu
dnf check-update           # Fedora/RHEL
yum check-update           # CentOS
pacman -Sy                # Arch
zypper refresh            # openSUSE
```

### æ¸…ç†ä»“åº“ç¼“å­˜
```bash
apt clean                 # æ¸…é™¤æ‰€æœ‰æœ¬åœ°ç¼“å­˜
apt autoclean            # æ¸…é™¤è¿‡æœŸç¼“å­˜

dnf clean all            # DNFæ¸…é™¤ç¼“å­˜
yum clean all            # YUMæ¸…é™¤ç¼“å­˜

pacman -Scc              # Pacmanæ¸…é™¤ç¼“å­˜
```

### åˆ—å‡ºä»“åº“è½¯ä»¶åŒ…
```bash
apt list --all-versions   # Debian/Ubuntu
dnf repository-packages <repo> list  # Fedora/RHEL
pacman -Sl <repo>        # Arch
zypper packages -r <repo>  # openSUSE
```

## ğŸ§  æœ€ä½³å®è·µå»ºè®®

1. **ä¼˜å…ˆä½¿ç”¨å®˜æ–¹ä»“åº“** - ç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§å’Œå®‰å…¨æ€§
2. **å®šæœŸæ›´æ–°ä»“åº“ç´¢å¼•** - `apt update`/`dnf check-update` ä¿æŒæœ€æ–°ä¿¡æ¯
3. **å¯†é’¥å®‰å…¨éªŒè¯** - å§‹ç»ˆéªŒè¯ä»“åº“å¯†é’¥çœŸå®æ€§
4. **ä»“åº“ä¼˜å…ˆçº§ç®¡ç†** - ä½¿ç”¨`/etc/apt/preferences`(APT)æˆ–`priority=`(DNF)è§£å†³å†²çª
5. **ä¼ä¸šç¯å¢ƒä½¿ç”¨é•œåƒ** - é…ç½®æœ¬åœ°é•œåƒåŠ é€Ÿä¸‹è½½å¹¶å‡å°‘å¤–éƒ¨ä¾èµ–
6. **å®¡è®¡ç¬¬ä¸‰æ–¹ä»“åº“** - å®šæœŸæ£€æŸ¥æ·»åŠ çš„ç¬¬ä¸‰æ–¹ä»“åº“æ˜¯å¦ä»åœ¨ç»´æŠ¤

> ğŸ’¡ é€šè¿‡æœ‰æ•ˆç®¡ç†è½¯ä»¶ä»“åº“ï¼Œæ‚¨å¯ä»¥ç¡®ä¿ç³»ç»Ÿå®‰å…¨ã€ç¨³å®šåœ°è·å–å’Œç»´æŠ¤è½¯ä»¶åŒ…ï¼ŒåŒæ—¶ä¼˜åŒ–æ›´æ–°æµç¨‹ã€‚