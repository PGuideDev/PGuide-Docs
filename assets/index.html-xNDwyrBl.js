import{_ as l,c as p,a as e,d as D,b as i,e as h,w as r,r as a,o as d}from"./app-Dk7ccnrl.js";const g={};function y(o,s){const n=a("VPIcon"),t=a("VPLink"),k=a("RepoCard");return d(),p("div",null,[e("p",null,[s[1]||(s[1]=h("编写者：",-1)),i(t,{href:"/friends/persons/"},{default:r(()=>[i(n,{provider:"iconify",name:"noto:red-heart"}),s[0]||(s[0]=h("db1",-1))]),_:1,__:[0]})]),s[2]||(s[2]=D(`<div class="hint-container note"><p class="hint-container-title">本文已完成，等待校对</p></div><h2 id="代码示例" tabindex="-1"><a class="header-anchor" href="#代码示例"><span>代码示例</span></a></h2><p><strong>监督机器学习的代码示例及步骤(以scikit-learn框架为例)：</strong></p><h3 id="_1-数据预处理" tabindex="-1"><a class="header-anchor" href="#_1-数据预处理"><span>1. 数据预处理</span></a></h3><p><strong>数据集导入</strong></p><div class="language-python" data-highlighter="shiki" data-ext="python" style="--shiki-light:#24292e;--shiki-dark:#D4D4D4;--shiki-light-bg:#fff;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes github-light dark-plus vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> pd.read_excel(</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;NHANES.xlsx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span></code></pre></div><p><strong>数据集的划分</strong> 以常见的8：2划分数据集为训练集和测试集</p><div class="language-python" data-highlighter="shiki" data-ext="python" style="--shiki-light:#24292e;--shiki-dark:#D4D4D4;--shiki-light-bg:#fff;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes github-light dark-plus vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">y</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">df[</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;GDM&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">]</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A9955;">#分类变量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">X</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">df[[</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;Age.Class&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;BMI.Class&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;Pregnancy.times&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;Parturition.times&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;UA&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;ALT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;AST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;GGT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;PLT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;Ca&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;NPAR&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">X_train, X_test, y_train, y_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> train_test_split(X, y, </span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">test_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">random_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span></code></pre></div><p><strong>是否需要 缺失值的插补</strong></p><p><strong>是否需要 平衡类别</strong></p><p>在这一步考虑训练集的类别是否平衡，是否需要进行平衡类别。例如对不平衡的数据集进行SMOTE过采样。</p><div class="language-python" data-highlighter="shiki" data-ext="python" style="--shiki-light:#24292e;--shiki-dark:#D4D4D4;--shiki-light-bg:#fff;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes github-light dark-plus vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">smote </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> SMOTE(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">random_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">X_resampled, y_resampled </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> smote.fit_resample(X_train, y_train)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#DCDCAA;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;平衡后数据集类别分布:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, Counter(y_resampled))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">X_train</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">X_resampled</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">y_train</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">y_resampled</span></span></code></pre></div><p><strong>数据的归一化</strong></p><h3 id="_2-模型选择" tabindex="-1"><a class="header-anchor" href="#_2-模型选择"><span>2. 模型选择</span></a></h3><p>这里以常见的几种模型为例，并以分类问题为例，尝试得到其训练集和测试集的accuracy，AUC，并以一个表格的形式展现出来。</p><div class="language-python has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="python" style="--vp-collapsed-lines:10;--shiki-light:#24292e;--shiki-dark:#D4D4D4;--shiki-light-bg:#fff;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes github-light dark-plus vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A9955;"># Model creation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">List_of_models </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> [LogisticRegression(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">random_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">), </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">                  KNeighborsClassifier(), </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">                  GaussianNB(), </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">                  DecisionTreeClassifier(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">random_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">                  SVC(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">probability</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#569CD6;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">), </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">                  RandomForestClassifier(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">random_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">List_of_models_for_graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;LogisticRegression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;KNeighborsClassifier&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;GaussianNB&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;DecisionTreeClassifier&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;SVM&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;RandomForestClassifier&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">df_results </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> pd.DataFrame(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;train accuracy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;test accuracy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;train auc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&quot;test auc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C586C0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#C586C0;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#DCDCAA;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#DCDCAA;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">(List_of_models)):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    model_class </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> List_of_models[i] </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    model_class.fit(X_train, y_train)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    y_scores </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> model_class.predict_proba(X_train)[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A9955;"># 获取正类的预测概率</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    auc1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> roc_auc_score(y_train, y_scores)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    y_scores </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> model_class.predict_proba(X_test)[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A9955;"># 获取正类的预测概率</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    auc2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> roc_auc_score(y_test, y_scores)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    results_classification </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> np.array([model_class.score(X_train,y_train), model_class.score(X_test,y_test),auc1,auc2])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    df_results[List_of_models_for_graph[i]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> results_classification</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">df_graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> df_results.transpose()</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A9955;">#行列交换，转置</span></span></code></pre><div class="collapsed-lines"></div></div><h3 id="_3-调参" tabindex="-1"><a class="header-anchor" href="#_3-调参"><span>3. 调参</span></a></h3><p>常用的调参方式为网格搜索，optuna。以下为对随机森林进行网格搜索调参的代码：</p><div class="language-python has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="python" style="--vp-collapsed-lines:10;--shiki-light:#24292e;--shiki-dark:#D4D4D4;--shiki-light-bg:#fff;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes github-light dark-plus vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">RandomForestClassifier_parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;criterion&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> : [</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;gini&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;entropy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">                                     &#39;n_estimators&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> : [</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">], </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">                                     &#39;min_samples_split&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> : [</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">], </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">                                     &#39;min_samples_leaf&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> : [</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">], </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">                                     &#39;max_features&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> : [</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;sqrt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;log2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">                                     }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">RandomForestClassifier_GridSearchCV </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> GridSearchCV(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">estimator</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> RandomForestClassifier(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">random_state</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">), </span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">param_grid</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> RandomForestClassifier_parameters, </span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">cv</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">n_jobs</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=-</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">verbose</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">        )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">RandomForestClassifier_GridSearchCV.fit(X_train, y_train)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">List_of_models[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">RandomForestClassifier_GridSearchCV.best_estimator_</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A9955;">#更新Model列表</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#DCDCAA;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">(RandomForestClassifier_GridSearchCV.best_params_)</span></span></code></pre><div class="collapsed-lines"></div></div><h3 id="_4-结果显示" tabindex="-1"><a class="header-anchor" href="#_4-结果显示"><span>4. 结果显示</span></a></h3><p>例如：以ROC作图的形式输出结果</p><div class="language-python has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="python" style="--vp-collapsed-lines:10;--shiki-light:#24292e;--shiki-dark:#D4D4D4;--shiki-light-bg:#fff;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes github-light dark-plus vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">models </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">    &quot;KNeighbors Classifier&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">: List_of_models[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">    &quot;GaussianNB&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">: List_of_models[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">    &quot;DecisionTree Classifier&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">: List_of_models[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">    &quot;SVM&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">: List_of_models[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">    &quot;RF&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">: List_of_models[</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A9955;"># 绘制ROC曲线</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.figure(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">figsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C586C0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> name, model </span><span style="--shiki-light:#D73A49;--shiki-dark:#C586C0;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> models.items():</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    y_scores </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> model.predict_proba(X_test)[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A9955;"># 获取正类的概率</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    fpr, tpr, _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> roc_curve(y_test, y_scores)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    roc_auc </span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;"> auc(fpr, tpr)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">    plt.plot(fpr, tpr, </span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">label</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#569CD6;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#569CD6;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">name</span><span style="--shiki-light:#005CC5;--shiki-dark:#569CD6;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;"> (AUC = </span><span style="--shiki-light:#005CC5;--shiki-dark:#569CD6;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">roc_auc</span><span style="--shiki-light:#D73A49;--shiki-dark:#569CD6;">:.3f</span><span style="--shiki-light:#005CC5;--shiki-dark:#569CD6;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.plot([</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;k--&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">label</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;Random Guess&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.title(</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;ROC Curve for Testing Set&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.xlabel(</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;False Positive Rate&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.ylabel(</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;True Positive Rate&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.legend(</span><span style="--shiki-light:#E36209;--shiki-dark:#9CDCFE;">loc</span><span style="--shiki-light:#D73A49;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#CE9178;">&#39;lower right&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.xlim([</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.ylim([</span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#B5CEA8;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.grid()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#D4D4D4;">plt.show()</span></span></code></pre><div class="collapsed-lines"></div></div><hr><h3 id="_5-完整代码下载" tabindex="-1"><a class="header-anchor" href="#_5-完整代码下载"><span>5. 完整代码下载</span></a></h3>`,24)),i(k,{repo:"db1-bot/mL-learning-notes"})])}const C=l(g,[["render",y]]),c=JSON.parse('{"path":"/learning-notes/ml/personal/db1/","title":"db1的机器学习笔记","lang":"zh-CN","frontmatter":{"title":"db1的机器学习笔记","createTime":"2025/02/24 03:13:20","permalink":"/learning-notes/ml/personal/db1/","icon":"/avatar/db1.jpg","description":"编写者： 本文已完成，等待校对 代码示例 监督机器学习的代码示例及步骤(以scikit-learn框架为例)： 1. 数据预处理 数据集导入 数据集的划分 以常见的8：2划分数据集为训练集和测试集 是否需要 缺失值的插补 是否需要 平衡类别 在这一步考虑训练集的类别是否平衡，是否需要进行平衡类别。例如对不平衡的数据集进行SMOTE过采样。 数据的归一化...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"db1的机器学习笔记\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-08-08T18:32:50.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://docs.pguide.dev/learning-notes/ml/personal/db1/"}],["meta",{"property":"og:site_name","content":"PGuide Docs"}],["meta",{"property":"og:title","content":"db1的机器学习笔记"}],["meta",{"property":"og:description","content":"编写者： 本文已完成，等待校对 代码示例 监督机器学习的代码示例及步骤(以scikit-learn框架为例)： 1. 数据预处理 数据集导入 数据集的划分 以常见的8：2划分数据集为训练集和测试集 是否需要 缺失值的插补 是否需要 平衡类别 在这一步考虑训练集的类别是否平衡，是否需要进行平衡类别。例如对不平衡的数据集进行SMOTE过采样。 数据的归一化..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-08-08T18:32:50.000Z"}],["meta",{"property":"article:modified_time","content":"2025-08-08T18:32:50.000Z"}]]},"readingTime":{"minutes":2.02,"words":605},"git":{"createdTime":1740340794000,"updatedTime":1754677970000,"contributors":[{"name":"rand777gg","username":"rand777gg","email":"losmosga@foxmail.com","commits":6,"avatar":"https://avatars.githubusercontent.com/rand777gg?v=4","url":"https://github.com/rand777gg"}],"changelog":[{"hash":"be3c2dc1ee53e24b659f4cad059625d7d1501616","time":1754677970000,"email":"rand777@pguide.studio","author":"rand777gg","message":"feat(docs/status): add the status card on learning-notes module"},{"hash":"2b52ff7c767469a297184062a55c03a08048f042","time":1741899539000,"email":"losmosga@foxmail.com","author":"rand777gg","message":"refactor: many updates"},{"hash":"c1c1493c82ae70e08795d98e59076b6212ad91e0","time":1740768054000,"email":"losmosga@foxmail.com","author":"rand777gg","message":"docs: alternate github repo"},{"hash":"4430b889fb0a844b48f9ffb912d23bdcb11717d6","time":1740716440000,"email":"losmosga@foxmail.com","author":"rand777gg","message":"docs: alternate the info"},{"hash":"f39f6a8e9a4d95cfb923150c59f6fb58721847fb","time":1740359536000,"email":"losmosga@foxmail.com","author":"rand777gg","message":"feat: new nav bar items"},{"hash":"9b348bc72249ba6c655f2b90554de393ce57e415","time":1740340794000,"email":"losmosga@foxmail.com","author":"rand777gg","message":"test: sidebar and navbar test"}]},"autoDesc":true,"filePathRelative":"notes/学习笔记/2.机器学习/星尘手札/db1.md","headers":[]}');export{C as comp,c as data};
